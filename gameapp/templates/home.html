<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Word Guess Game - Home</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light d-flex flex-column align-items-center justify-content-center min-vh-100">
<div class="card shadow-lg p-4 text-center" style="max-width: 500px; width: 100%;">

    <h2 class="mb-3">Welcome, <span class="text-primary">{{ username }}</span>!</h2>
</div>

    {% if request.session.user_type == 'admin' %}
    <div class="card shadow-lg p-4 text-center" style="max-width: 500px; width: 100%;">
        <h5 class="mb-4 text-warning">Admin Panel</h5>
        {% if messages %}
        <div class="container mt-3">
            {% for message in messages %}
                <div class="alert alert-danger text-center">{{ message }}</div>
            {% endfor %}
        </div>
        {% endif %}
        <a href="{% url 'daily_report' %}" class="btn btn-outline-primary mb-2 w-100">Daily Report</a>
        <form method="get" action="{% url 'user_report' %}" class="d-flex mb-2">
            <select name="username" class="form-select flex-grow-1 me-2" style="height: 60px;" required>
                <option value="">-- Select Player --</option>
                {% for player in players %}
                    <option value="{{ player.username }}">{{ player.username }}</option>
                {% endfor %}
            </select>
            <button type="submit" class="btn btn-outline-success" style="height: 60px;">User Report</button>
        </form>
    </div>
    {% else %}
    <div class="card shadow-lg p-4 text-center" style="max-width: 500px; width: 100%;">
        {% if messages %}
        <div class="container mt-3">
            {% for message in messages %}
                <div class="alert alert-danger text-center">{{ message }}</div>
            {% endfor %}
        </div>
        {% endif %}
        <h5 class="mb-4">Words Guessed Today: <span class="badge bg-success">{{ games_played_today }}</span></h5>
        <p class="mb-3">Click the button below to start a new word guess game:</p>
        <form action="{% url 'start_game' %}" method="get" class="d-grid">
            <button type="submit" class="btn btn-lg btn-success">Start Game</button>
        </form>
        {% if limit_reached %}
        <div class="modal fade show d-block" id="limitModal" tabindex="-1" aria-labelledby="limitModalLabel" aria-hidden="true" style="background-color: rgba(0,0,0,0.5);">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content text-center p-3">
                    <div class="modal-body">
                        <p class="fs-5 fw-bold">You have already guessed 3 words today!</p>
                    </div>
                    <div class="modal-footer justify-content-center">
                        <button type="button" class="btn btn-primary" id="limitBtn">OK</button>
                    </div>
                </div>
            </div>
        </div>
        {% endif %}
    {% endif %}

    <p class="mt-4">
        <a href="{% url 'logout' %}" class="btn btn-outline-danger btn-sm">Logout</a>
    </p>
    </div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<script>
document.addEventListener("DOMContentLoaded", function () {
    const modal = document.getElementById("limitModal");
    const btn = document.getElementById("limitBtn");

    if (modal && btn) {
        btn.addEventListener("click", function () {
            window.location.href = "{% url 'home' %}";
        });
    }
});
</script>
</body>
</html>
